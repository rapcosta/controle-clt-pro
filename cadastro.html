<script>

const uidEditar=localStorage.getItem("funcionarioEditando")

if(uidEditar){
carregarParaEdicao()
}

async function carregarParaEdicao(){

const { data } = await supabaseClient
.from("funcionarios")
.select("*")
.eq("uid",uidEditar)
.single()

if(!data) return

nome.value=data.nome||""
cpf.value=data.cpf||""
cargo.value=data.cargo||""
setor.value=data.setor||""
salario.value=data.salario||""
}

async function salvar(){

const funcionario={
nome:nome.value,
cpf:cpf.value,
cargo:cargo.value,
setor:setor.value,
salario:Number(salario.value||0)
}

if(uidEditar){

const { error } = await supabaseClient
.from("funcionarios")
.update(funcionario)
.eq("uid",uidEditar)

if(error){
alert("Erro ao atualizar")
return
}

alert("Atualizado com sucesso")
localStorage.removeItem("funcionarioEditando")
location="funcionarios.html"

}else{

const { error } = await supabaseClient
.from("funcionarios")
.insert([funcionario])

if(error){
alert("Erro ao cadastrar")
return
}

alert("Cadastrado com sucesso")
location="funcionarios.html"
}
}
</script>
